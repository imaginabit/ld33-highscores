<!doctype html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Game Scores</title>
  <meta name="description" content="High Scores">
  <link rel="stylesheet" href="css/styles.css">

  <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.5.0.min.js"></script>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="parse_key.js"></script>
  <script src="functions.js"></script>

</head>

<body>
  <div class="container">
    <div class="row">
      <div class="col-md-8">
        <ul class="nav nav-tabs" role="tablist">
          <li role="presentation" class="active"><a href="#tscore" role="tab" data-toggle="tab">Top Score</a></li>
          <li role="presentation"><a href="#ticecream" role="tab" data-toggle="tab">Top Ice Creams</a></li>
          <li role="presentation"><a href="#tdestroyed" role="tab" data-toggle="tab">Top Destruction</a></li>
          <li role="presentation"><a href="#tlast" role="tab" data-toggle="tab">Last Scores</a></li>
        </ul>
        <div class="tab-content">
          <div role="tabpanel" class="tab-pane active" id="tscore">
            <h1 id='title'>Scores</h1>
            <table id='scores' class="table">
              <thead>
                <th>Player Name</th>
                <th>Score</th>
                <th>Ice cream</th>
                <th>Destroyed</th>
              </thead>
            </table>
          </div>
          <div role="tabpanel" class="tab-pane" id="ticecream">
            <h1 id='title'>Ice Cream</h1>
            <table id='icecreamScores' class="table">
              <thead>
                <th>Player Name</th>
                <th>Score</th>
                <th>Ice cream</th>
                <th>Destroyed</th>
              </thead>
            </table>
          </div>
          <div role="tabpanel" class="tab-pane" id="tdestroyed">
            <h1 id='title'>Destroyed</h1>
            <table id='destroyScores' class="table">
              <thead>
                <th>Player Name</th>
                <th>Score</th>
                <th>Ice cream</th>
                <th>Destroyed</th>
              </thead>
            </table>
          </div>
          <div role="tabpanel" class="tab-pane" id="tlast">
            <h1 id='title'>Last Scores</h1>
            <table id='lastScores' class="table">
              <thead>
                <th>Player Name</th>
                <th>Score</th>
                <th>Ice cream</th>
                <th>Destroyed</th>
              </thead>
            </table>
          </div>
        </div>
      </div>

      <div class="col-md-4 lateral" >
        <div class="btn btn-default total">Total Ice Cream
          <span id='totalIceCream'></span>
        </div>
        <div id="totalDestroyedBox" class="btn btn-default total">Total destroyed
          <span id='totalDestroyed'></span>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript">
    var GameScore = Parse.Object.extend("GameScore");
    var query = new Parse.Query(GameScore);
    query.descending("score");
    query.limit(10);
    getScoresPrint(query, '#scores');

    var ql = new Parse.Query(GameScore);
    ql.descending("createdAt");
    ql.limit(10);
    getScoresPrint(ql, '#lastScores');

    var qic = new Parse.Query(GameScore);
    qic.descending("icecream");
    qic.limit(10);
    getScoresPrint(qic, '#icecreamScores');

    var qd = new Parse.Query(GameScore);
    qd.descending("destroyed");
    qd.limit(10);
    getScoresPrint(qd, '#destroyScores');

    var total = Parse.Object.extend("Total");
    var totalq = new Parse.Query(total);
    totalq.descending("createdAt");
    totalq.find({
      success: function(totales) {
        lastTotal = totales[0];
        icecream = lastTotal.get('icecream');
        destroyed = lastTotal.get('destroyed');
        // score = lastTotal.get('score');
        $("#totalIceCream").html(icecream);
        $("#totalDestroyed").html(destroyed);
      },
      error: function(error) {
        $("#totalIceCream").html(error);
        console.log(error);
      }
    });
  </script>
</body>

</html>
